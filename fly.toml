app = "stranger-music"
primary_region = "iad"

# ===============================
# Build Configuration
# ===============================
[build]
  dockerfile = "Dockerfile"

# ===============================
# Environment Variables ([env])
# ===============================
[env]
  # ╪к╪н╪│┘К┘Ж╪з╪к ╪и╪з┘К╪л┘И┘Ж ╪з┘Д╪╣╪з┘Е╪й
  PYTHONUNBUFFERED = "1"
  PYTHONDONTWRITEBYTECODE = "1"
  
  # ╪к┘И╪м┘К┘З ╪з┘Д┘Е┘Д┘Б╪з╪к ╪з┘Д┘Е╪д┘В╪к╪й ┘Д┘Д╪▒╪з┘Е ╪п┘К╪│┘Г (╪╢╪▒┘И╪▒┘К ┘Е╪╣ ╪з┘Д┘Г┘И╪п ╪з┘Д╪м╪п┘К╪п)
  TMPDIR = "/dev/shm"

  # тЪая╕П ╪е╪м╪и╪з╪▒ ╪з┘Д┘Ж╪╕╪з┘Е ╪╣┘Д┘Й ╪з╪│╪к╪о╪п╪з┘Е IPv4 ┘Б┘В╪╖
  # ┘З╪░╪з ╪г┘З┘Е ╪│╪╖╪▒ ┘Д┘Е┘Ж╪╣ ╪н╪╕╪▒ ┘К┘И╪к┘К┘И╪и (HTTP 429 Errors)
  IP_VERSION = "4"

  # CPU Acceleration (┘Д┘Д╪з╪│╪к┘Б╪з╪п╪й ┘Е┘Ж ╪з┘Д┘А 16 ┘Г┘И╪▒ ┘Б┘К OpenCV ┘И Numpy)
  OMP_NUM_THREADS = "16"
  MKL_NUM_THREADS = "16"
  NUMEXPR_NUM_THREADS = "16"

# ===============================
# Network Tuning (YouTube Booster) ЁЯЪА
# ===============================
[sysctl]
  # ╪к┘Б╪╣┘К┘Д ╪о┘И╪з╪▒╪▓┘Е┘К╪й BBR (╪╡╪з╪▒┘И╪о ┘К┘И╪к┘К┘И╪и)
  "net.core.default_qdisc" = "fq"
  "net.ipv4.tcp_congestion_control" = "bbr"

  # ┘Б╪к╪н ╪╡┘Ж╪и┘И╪▒ ╪з┘Д╪п╪з╪к╪з (Buffers) ┘Д╪з╪│╪к╪║┘Д╪з┘Д ╪з┘Д╪▒╪з┘Е ╪з┘Д┘А 100 ╪м┘К╪м╪з
  "net.core.rmem_max" = "16777216"
  "net.core.wmem_max" = "16777216"
  "net.ipv4.tcp_rmem" = "4096 87380 16777216"
  "net.ipv4.tcp_wmem" = "4096 65536 16777216"
  
  # ┘Е┘Ж╪╣ ╪з┘Д╪к┘В╪╖┘К╪╣ ╪╣┘Ж╪п ╪з┘Д╪╢╪║╪╖
  "net.ipv4.tcp_window_scaling" = "1"
  "net.ipv4.tcp_slow_start_after_idle" = "0"

# ===============================
# Machine Specs (The Beast)
# ===============================
[[vm]]
  cpu_kind = "performance"
  cpus = 16
  memory_mb = 131072
